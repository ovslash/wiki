---
import StarlightPage from '@astrojs/starlight/components/StarlightPage.astro';
import { getCollection } from 'astro:content';
import { slugify } from '../../lib/slug';

const docs = await getCollection('docs');
const counts = new Map<string, number>();
for (const d of docs) for (const t of d.data.tags ?? []) {
  const s = slugify(t);
  counts.set(s, (counts.get(s) ?? 0) + 1);
}
const items = [...counts.entries()].sort((a, b) => a[0].localeCompare(b[0]));
const base = import.meta.env.BASE_URL || '/';
---

<StarlightPage frontmatter={{ title: 'Tous les Tags' }} hasSidebar={true}>
  <ul>
    {items.map(([slug, n]) => (
      <li><a href={`${base}tags/${slug}/`}>{slug}</a> <small>({n})</small></li>
    ))}
  </ul>
</StarlightPage>
